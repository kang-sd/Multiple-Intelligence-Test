<!DOCTYPE html>
<html lang="ko">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>MI Â· ë‹¤ì¤‘ì§€ëŠ¥ ê²€ì‚¬</title>
  <link href="https://fonts.googleapis.com/css2?family=Cormorant+Garamond:ital,wght@0,300;0,400;0,600;1,300;1,400&family=Noto+Serif+KR:wght@300;400;600&display=swap" rel="stylesheet">
  <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
  <style>
    :root {
      --bg:      #faf8f4;
      --surface: #ffffff;
      --ink:     #1a1612;
      --ink2:    #4a4540;
      --gold:    #b8903a;
      --gold2:   #d4aa5a;
      --gold-bg: #fdf6e9;
      --border:  #e8e2d8;
      --accent:  #8b6914;
    }
    *, *::before, *::after { box-sizing: border-box; margin: 0; padding: 0; }
    body { background: var(--bg); color: var(--ink); font-family: 'Noto Serif KR', serif; min-height: 100vh; }

    .top-bar { height: 4px; background: linear-gradient(90deg, var(--gold), var(--gold2), var(--gold)); }
    .container { max-width: 780px; margin: 0 auto; padding: 0 24px 80px; }

    /* í—¤ë” */
    .header { text-align: center; padding: 52px 0 44px; animation: fadeDown 0.8s ease both; }
    .header-eyebrow { font-size: 10px; letter-spacing: 5px; text-transform: uppercase; color: var(--gold); margin-bottom: 18px; }
    .header h1 { font-family: 'Cormorant Garamond', serif; font-size: clamp(48px,10vw,84px); font-weight: 300; font-style: italic; color: var(--ink); line-height: 0.95; letter-spacing: -2px; }
    .header h1 span { color: var(--gold); }
    .header-rule { width: 50px; height: 1px; background: linear-gradient(90deg,transparent,var(--gold),transparent); margin: 22px auto 18px; }
    .header-sub { font-size: 13px; color: var(--ink2); }

    /* ì•ˆë‚´ ì¹´ë“œ */
    .intro-cards { display: grid; grid-template-columns: repeat(4,1fr); gap: 1px; background: var(--border); border: 1px solid var(--border); margin-bottom: 44px; animation: fadeUp 0.8s 0.2s ease both; }
    .intro-card { background: var(--surface); padding: 24px 18px; text-align: center; }
    .intro-card-num { font-family: 'Cormorant Garamond', serif; font-size: 38px; font-weight: 300; color: var(--gold); line-height: 1; margin-bottom: 6px; }
    .intro-card-title { font-size: 9px; letter-spacing: 3px; text-transform: uppercase; color: var(--gold); margin-bottom: 8px; }
    .intro-card p { font-size: 12px; color: var(--ink2); line-height: 1.6; }

    /* ì´ë¦„ ì…ë ¥ */
    .name-section { margin-bottom: 36px; animation: fadeUp 0.8s 0.3s ease both; }
    .section-label { font-size: 10px; letter-spacing: 4px; text-transform: uppercase; color: var(--gold); margin-bottom: 10px; }
    .name-row { display: flex; gap: 10px; }
    .name-input { flex: 1; background: var(--surface); border: 1px solid var(--border); color: var(--ink); font-family: 'Noto Serif KR', serif; font-size: 16px; padding: 14px 18px; outline: none; transition: border-color 0.25s; }
    .name-input:focus { border-color: var(--gold); }
    .name-input::placeholder { color: #bbb; }
    .btn-search { background: var(--surface); border: 1px solid var(--gold); color: var(--gold); font-family: 'Cormorant Garamond', serif; font-size: 15px; letter-spacing: 2px; padding: 14px 26px; cursor: pointer; transition: all 0.25s; white-space: nowrap; }
    .btn-search:hover { background: var(--gold); color: #fff; }

    /* í™•ì¸ ë‹¤ì´ì–¼ë¡œê·¸ */
    .confirm-box { background: var(--gold-bg); border: 1px solid rgba(184,144,58,0.3); padding: 22px 24px; margin-bottom: 28px; animation: fadeUp 0.3s ease; }
    .confirm-box p { font-size: 15px; color: var(--ink); margin-bottom: 16px; line-height: 1.7; }
    .confirm-btns { display: flex; gap: 10px; }
    .btn-yes { background: var(--gold); border: none; color: #fff; font-family: 'Noto Serif KR', serif; font-size: 14px; padding: 11px 26px; cursor: pointer; transition: opacity 0.2s; }
    .btn-yes:hover { opacity: 0.85; }
    .btn-no { background: transparent; border: 1px solid var(--border); color: var(--ink2); font-family: 'Noto Serif KR', serif; font-size: 14px; padding: 11px 26px; cursor: pointer; transition: all 0.2s; }
    .btn-no:hover { border-color: var(--ink2); color: var(--ink); }

    /* ì§„í–‰ ë°” */
    .progress-wrap { position: sticky; top: 0; z-index: 10; background: var(--bg); padding: 10px 0 14px; border-bottom: 1px solid var(--border); margin-bottom: 8px; display: none; }
    .progress-bar-bg { height: 2px; background: var(--border); position: relative; }
    .progress-bar-fill { position: absolute; inset: 0; background: linear-gradient(90deg,var(--gold),var(--gold2)); transform-origin: left; transform: scaleX(0); transition: transform 0.3s ease; }
    .progress-text { font-size: 11px; letter-spacing: 1px; color: var(--ink2); text-align: right; margin-top: 6px; }

    /* ë¬¸í•­ êµ¬ë¶„ì„  */
    .questions-header { display: none; align-items: center; gap: 18px; margin-bottom: 8px; }
    .questions-header-line { flex: 1; height: 1px; background: var(--border); }
    .questions-header-text { font-size: 10px; letter-spacing: 4px; text-transform: uppercase; color: var(--gold); }

    /* ë¬¸í•­ */
    #miForm { animation: fadeUp 0.8s 0.4s ease both; }
    .question { border-bottom: 1px solid var(--border); padding: 24px 0; }
    .question:last-child { border-bottom: none; }
    .q-meta { display: flex; align-items: baseline; gap: 12px; margin-bottom: 14px; }
    .q-num { font-family: 'Cormorant Garamond', serif; font-size: 13px; color: var(--gold); min-width: 28px; opacity: 0.6; }
    .q-text { font-size: 15px; color: var(--ink); line-height: 1.65; }
    .q-choices { display: flex; gap: 10px; padding-left: 40px; flex-wrap: wrap; }
    .btn-choice { background: var(--surface); border: 1px solid var(--border); color: var(--ink2); font-family: 'Noto Serif KR', serif; font-size: 14px; padding: 11px 22px; cursor: pointer; transition: all 0.2s; }
    .btn-choice:hover { border-color: var(--gold2); color: var(--ink); background: var(--gold-bg); }
    .btn-choice.selected { background: var(--gold); border-color: var(--gold); color: #fff; font-weight: 600; }

    /* ë¯¸ì‘ë‹µ í•˜ì´ë¼ì´íŠ¸ */
    .question.unanswered { background: #fff5f5; border-left: 3px solid #e05252; padding-left: 14px; margin-left: -17px; }
    .question.unanswered .q-num { color: #e05252; opacity: 1; }

    /* ê²½ê³  */
    .warning-bar { background: #fff5f5; border-left: 3px solid #e05252; color: #b83232; padding: 12px 18px; font-size: 13px; margin: 12px 0; display: none; line-height: 1.6; }

    /* ì œì¶œ ë²„íŠ¼ */
    .submit-wrap { padding: 40px 0 0; text-align: center; }
    .btn-submit { background: var(--gold); border: none; color: #fff; font-family: 'Cormorant Garamond', serif; font-size: 18px; letter-spacing: 3px; padding: 18px 60px; cursor: pointer; width: 100%; max-width: 380px; transition: background 0.25s, transform 0.15s; }
    .btn-submit:hover { background: var(--accent); transform: translateY(-1px); }
    .btn-submit:disabled { opacity: 0.5; cursor: not-allowed; transform: none; }

    /* ìŠ¤í”¼ë„ˆ */
    #spinner { display: none; text-align: center; padding: 60px 0; }
    .spinner-ring { width: 44px; height: 44px; border: 2px solid var(--border); border-top-color: var(--gold); border-radius: 50%; animation: spin 0.9s linear infinite; margin: 0 auto 14px; }
    .spinner-text { font-size: 12px; letter-spacing: 2px; color: var(--ink2); text-transform: uppercase; }

    /* ê²°ê³¼ ì„¹ì…˜ */
    #resultSection { display: none; animation: fadeUp 0.7s ease both; }
    .result-header { text-align: center; padding: 56px 0 44px; border-bottom: 1px solid var(--border); margin-bottom: 44px; }
    .result-eyebrow { font-size: 10px; letter-spacing: 5px; text-transform: uppercase; color: var(--gold); margin-bottom: 22px; }
    .result-top3 { display: flex; gap: 0; justify-content: center; flex-wrap: wrap; margin-bottom: 20px; }
    .top-badge { text-align: center; padding: 0 24px; }
    .top-badge:not(:last-child) { border-right: 1px solid var(--border); }
    .top-rank { font-family: 'Cormorant Garamond', serif; font-size: 11px; color: var(--gold); opacity: 0.7; margin-bottom: 6px; letter-spacing: 2px; }
    .top-name { font-family: 'Cormorant Garamond', serif; font-size: 20px; font-weight: 300; color: var(--ink); }
    .top-name.first { font-size: 32px; color: var(--gold); font-style: italic; }
    .top-score { font-size: 11px; color: var(--ink2); margin-top: 4px; letter-spacing: 1px; }
    .result-sub { font-size: 13px; color: var(--ink2); font-style: italic; line-height: 1.8; }

    /* ì°¨íŠ¸ */
    .chart-section { background: var(--surface); border: 1px solid var(--border); padding: 28px 24px; margin-bottom: 16px; }
    .chart-title { font-size: 10px; letter-spacing: 4px; text-transform: uppercase; color: var(--gold); margin-bottom: 16px; text-align: center; }
    .chart-toggle { display: flex; gap: 8px; justify-content: center; margin-bottom: 20px; }
    .btn-chart-toggle { background: var(--surface); border: 1px solid var(--border); color: var(--ink2); font-family: 'Noto Serif KR', serif; font-size: 12px; padding: 6px 18px; cursor: pointer; transition: all 0.2s; }
    .btn-chart-toggle.active { background: var(--gold); border-color: var(--gold); color: #fff; }

    /* ì ìˆ˜ ë°” */
    .score-table-wrap { margin-bottom: 40px; border: 1px solid var(--border); background: var(--surface); }
    .score-table-title { font-size: 10px; letter-spacing: 4px; text-transform: uppercase; color: var(--gold); padding: 16px 20px 12px; border-bottom: 1px solid var(--border); background: var(--gold-bg); }
    .score-row { display: grid; grid-template-columns: 130px 1fr 50px; align-items: center; gap: 14px; padding: 11px 20px; border-bottom: 1px solid var(--border); }
    .score-row:last-child { border-bottom: none; }
    .score-row.top1 { background: rgba(184,144,58,0.05); }
    .score-row.top1 .score-type { color: var(--gold); font-weight: 600; }
    .score-type { font-size: 13px; color: var(--ink2); }
    .score-bar-bg { height: 4px; background: var(--border); border-radius: 2px; overflow: hidden; position: relative; }
    .score-bar-fill { position: absolute; left: 0; top: 0; height: 100%; border-radius: 2px; background: linear-gradient(90deg,var(--gold),var(--gold2)); transition: width 1s ease; }
    .score-val { font-family: 'Cormorant Garamond', serif; font-size: 20px; color: var(--ink); text-align: right; }
    .score-val.top1 { color: var(--gold); }

    /* ê²°ê³¼ ìƒì„¸ */
    .result-fields { border: 1px solid var(--border); margin-bottom: 40px; background: var(--surface); }
    .field-type-title { font-size: 10px; letter-spacing: 4px; text-transform: uppercase; color: var(--gold); padding: 16px 20px 12px; border-bottom: 1px solid var(--border); background: var(--gold-bg); }
    .field-row { display: grid; grid-template-columns: 120px 1fr; border-bottom: 1px solid var(--border); }
    .field-row:last-child { border-bottom: none; }
    .field-key { padding: 16px 14px 16px 20px; font-size: 10px; letter-spacing: 2px; text-transform: uppercase; color: var(--gold); background: var(--gold-bg); border-right: 1px solid var(--border); display: flex; align-items: flex-start; padding-top: 17px; line-height: 1.6; }
    .field-val { padding: 15px 20px; font-size: 14px; color: var(--ink2); line-height: 1.85; }

    /* ë²„íŠ¼ */
    .result-actions { display: flex; gap: 12px; justify-content: center; flex-wrap: wrap; }
    .btn-print { background: var(--gold); border: none; color: #fff; font-family: 'Noto Serif KR', serif; font-size: 15px; padding: 16px 36px; cursor: pointer; transition: background 0.2s, transform 0.15s; display: flex; align-items: center; gap: 8px; }
    .btn-print:hover { background: var(--accent); transform: translateY(-1px); }
    .btn-restart { background: var(--surface); border: 1px solid var(--border); color: var(--ink2); font-family: 'Noto Serif KR', serif; font-size: 15px; padding: 16px 36px; cursor: pointer; transition: all 0.2s; }
    .btn-restart:hover { border-color: var(--ink); color: var(--ink); }

    /* ê´€ë¦¬ì ëª¨ë‹¬ */
    .modal-overlay { position: fixed; inset: 0; background: rgba(26,22,18,0.75); z-index: 1000; display: none; align-items: center; justify-content: center; }
    .modal-overlay.open { display: flex; }
    .modal { background: var(--surface); width: 100%; max-width: 560px; max-height: 90vh; overflow-y: auto; border-top: 3px solid var(--gold); animation: fadeUp 0.3s ease; }
    .modal-header { padding: 28px 28px 20px; border-bottom: 1px solid var(--border); display: flex; align-items: center; justify-content: space-between; }
    .modal-title { font-family: 'Cormorant Garamond', serif; font-size: 22px; font-weight: 300; color: var(--ink); letter-spacing: 1px; }
    .modal-close { background: none; border: none; font-size: 22px; color: var(--ink2); cursor: pointer; padding: 4px 8px; }
    .modal-close:hover { color: var(--ink); }
    .modal-body { padding: 24px 28px; }
    .pw-form { display: flex; flex-direction: column; gap: 14px; }
    .pw-input { background: var(--bg); border: 1px solid var(--border); color: var(--ink); font-family: 'Noto Serif KR', serif; font-size: 20px; padding: 14px 18px; outline: none; text-align: center; letter-spacing: 10px; transition: border-color 0.25s; }
    .pw-input:focus { border-color: var(--gold); }
    .btn-pw-ok { background: var(--gold); border: none; color: #fff; font-family: 'Cormorant Garamond', serif; font-size: 16px; letter-spacing: 2px; padding: 14px; cursor: pointer; transition: background 0.2s; }
    .btn-pw-ok:hover { background: var(--accent); }
    .pw-error { color: #c0392b; font-size: 13px; text-align: center; display: none; }
    .admin-toolbar { display: flex; align-items: center; justify-content: space-between; margin-bottom: 16px; flex-wrap: wrap; gap: 10px; }
    .admin-count { font-size: 12px; color: var(--ink2); letter-spacing: 1px; }
    .btn-admin-refresh { background: none; border: 1px solid var(--border); color: var(--ink2); font-family: 'Noto Serif KR', serif; font-size: 13px; padding: 7px 16px; cursor: pointer; transition: all 0.2s; }
    .btn-admin-refresh:hover { border-color: var(--gold); color: var(--gold); }
    .admin-list { display: flex; flex-direction: column; gap: 8px; }
    .admin-item { display: grid; grid-template-columns: 1fr auto auto; align-items: center; gap: 12px; padding: 14px 16px; background: var(--bg); border: 1px solid var(--border); }
    .admin-item.expired { opacity: 0.5; border-style: dashed; }
    .admin-item-name { font-size: 15px; color: var(--ink); margin-bottom: 3px; }
    .admin-item-time { font-size: 11px; color: var(--ink2); }
    .admin-item-type { font-family: 'Cormorant Garamond', serif; font-size: 13px; color: var(--gold); margin-top: 2px; }
    .admin-item-badge { font-size: 10px; letter-spacing: 1px; padding: 3px 8px; border: 1px solid; margin-left: 8px; }
    .badge-active  { color: var(--gold); border-color: var(--gold); background: var(--gold-bg); }
    .badge-expired { color: #999; border-color: #ccc; background: #f5f5f5; }
    .btn-view-result { background: none; border: 1px solid var(--gold); color: var(--gold); font-family: 'Noto Serif KR', serif; font-size: 12px; padding: 6px 14px; cursor: pointer; transition: all 0.2s; white-space: nowrap; }
    .btn-view-result:hover { background: var(--gold); color: #fff; }
    .btn-del { background: none; border: 1px solid var(--border); color: #c0392b; font-family: 'Noto Serif KR', serif; font-size: 12px; padding: 6px 14px; cursor: pointer; transition: all 0.2s; white-space: nowrap; }
    .btn-del:hover { background: #fdf0ee; border-color: #c0392b; }
    .admin-empty { text-align: center; color: var(--ink2); font-size: 14px; padding: 40px 0; font-style: italic; }

    @keyframes fadeDown { from{opacity:0;transform:translateY(-16px)} to{opacity:1;transform:translateY(0)} }
    @keyframes fadeUp   { from{opacity:0;transform:translateY(16px)}  to{opacity:1;transform:translateY(0)} }
    @keyframes spin     { to{transform:rotate(360deg)} }

    /* ì¸ì‡„ */
    @media print {
      .top-bar,.header,.intro-cards,.name-section,
      .progress-wrap,.questions-header,#miForm,
      .warning-bar,.submit-wrap,#spinner,
      #searchResponse,#searchWarningBox,#answerWarningBox,
      .result-actions,.modal-overlay,.chart-toggle { display: none !important; }
      body { background:#fff !important; -webkit-print-color-adjust:exact; print-color-adjust:exact; }
      .container { max-width:100%; padding:0 16px; }
      #resultSection { display:block !important; }
      .print-only-header { display:flex !important; justify-content:space-between; align-items:center; padding:12px 0; border-bottom:2px solid #b8903a; margin-bottom:0; }
      .print-only-header .brand { font-family:'Cormorant Garamond',serif; font-size:18pt; font-style:italic; color:#b8903a; }
      .print-only-header .print-date { font-size:9pt; color:#888; }
    }

    @media (max-width:600px) {
      .intro-cards { grid-template-columns:repeat(2,1fr); }
      .q-choices { padding-left:0; flex-direction:column; }
      .btn-choice { width:100%; }
      .field-row { grid-template-columns:1fr; }
      .field-key { border-right:none; border-bottom:1px solid var(--border); }
      .score-row { grid-template-columns:100px 1fr 38px; gap:10px; }
    }
  </style>
</head>
<body>

<!-- ê´€ë¦¬ì ëª¨ë‹¬ -->
<div class="modal-overlay" id="adminOverlay">
  <div class="modal">
    <div class="modal-header">
      <div class="modal-title" id="modalTitle">ê´€ë¦¬ì ì¸ì¦</div>
      <button class="modal-close" onclick="closeAdmin()">âœ•</button>
    </div>
    <div class="modal-body">
      <div id="pwPanel">
        <div class="pw-form">
          <input class="pw-input" type="password" id="pwInput" placeholder="â—â—â—â—" maxlength="20"
            onkeydown="if(event.key==='Enter') doAdminLogin()">
          <button class="btn-pw-ok" onclick="doAdminLogin()">í™•ì¸</button>
          <div class="pw-error" id="pwError">ë¹„ë°€ë²ˆí˜¸ê°€ ì˜¬ë°”ë¥´ì§€ ì•ŠìŠµë‹ˆë‹¤.</div>
        </div>
      </div>
      <div id="listPanel" style="display:none;">
        <div class="admin-toolbar">
          <div class="admin-count" id="adminCount"></div>
          <button class="btn-admin-refresh" onclick="loadAdminList()">â†» ìƒˆë¡œê³ ì¹¨</button>
        </div>
        <div class="admin-list" id="adminList"></div>
      </div>
    </div>
  </div>
</div>

<div class="top-bar"></div>
<div class="container">

  <div class="print-only-header" style="display:none;">
    <div class="brand">MI Â· ë‹¤ì¤‘ì§€ëŠ¥ê²€ì‚¬</div>
    <div class="print-date" id="printDate"></div>
  </div>

  <!-- í—¤ë” -->
  <div class="header">
    <div class="header-eyebrow">Howard Gardner Â· ë‹¤ì¤‘ ì§€ëŠ¥ ì´ë¡ </div>
    <h1 onclick="openAdmin()" style="cursor:default;"><span>M</span>I</h1>
    <div class="header-rule"></div>
    <div class="header-sub">ë‹¹ì‹  ì•ˆì— ìˆ¨ê²¨ì§„ 8ê°€ì§€ ì§€ëŠ¥ì„ ë°œê²¬í•˜ë‹¤</div>
  </div>

  <!-- ì•ˆë‚´ ì¹´ë“œ -->
  <div class="intro-cards">
    <div class="intro-card">
      <div class="intro-card-num">48</div>
      <div class="intro-card-title">ë¬¸í•­ êµ¬ì„±</div>
      <p>8ê°€ì§€ ì§€ëŠ¥ì„ ì¸¡ì •í•˜ëŠ”<br>48ê°œ ì •ë°€ ë¬¸í•­</p>
    </div>
    <div class="intro-card">
      <div class="intro-card-num">8</div>
      <div class="intro-card-title">ì§€ëŠ¥ ìœ í˜•</div>
      <p>ì–¸ì–´Â·ë…¼ë¦¬Â·ìŒì•…Â·ì‹ ì²´<br>ê³µê°„Â·ëŒ€ì¸Â·ìê¸°Â·ìì—°</p>
    </div>
    <div class="intro-card">
      <div class="intro-card-num">3</div>
      <div class="intro-card-title">ì¼ ë³´ê´€</div>
      <p>ì´ë¦„ ê²€ìƒ‰ìœ¼ë¡œ<br>3ì¼ ì´ë‚´ ì¬í™•ì¸ ê°€ëŠ¥</p>
    </div>
    <div class="intro-card">
      <div class="intro-card-num">âˆ</div>
      <div class="intro-card-title">ì‹œê°í™”</div>
      <p>ë ˆì´ë”Â·ë§‰ëŒ€ ì°¨íŠ¸ë¡œ<br>ì§€ëŠ¥ í”„ë¡œí•„ í•œëˆˆì—</p>
    </div>
  </div>

  <!-- ì´ë¦„ ì…ë ¥ -->
  <div class="name-section">
    <div class="section-label">ì´ë¦„ ì…ë ¥</div>
    <div class="name-row">
      <input class="name-input" type="text" id="nameInput" placeholder="ì„±í•¨ì„ ì…ë ¥í•˜ì„¸ìš”" autocomplete="off">
      <button class="btn-search" onclick="searchPrevious()">ê²€ìƒ‰</button>
    </div>
  </div>

  <div class="warning-bar" id="searchWarningBox"></div>
  <div id="searchResponse"></div>

  <!-- ìŠ¤í”¼ë„ˆ -->
  <div id="spinner">
    <div class="spinner-ring"></div>
    <div class="spinner-text">ë¬¸í•­ ë¶ˆëŸ¬ì˜¤ëŠ” ì¤‘</div>
  </div>

  <!-- ì§„í–‰ ë°” -->
  <div class="progress-wrap" id="progressWrap">
    <div id="nameReminderBar"
      style="display:none;background:#fff8e1;border-left:3px solid #ffc107;color:#7c5c00;padding:8px 14px;font-size:13px;margin-bottom:8px;cursor:pointer;"
      onclick="document.getElementById('nameInput').focus();document.querySelector('.name-section').scrollIntoView({behavior:'smooth'});">
      âœï¸ ì„±í•¨ì„ ì…ë ¥í•´ì£¼ì„¸ìš” â€” ì—¬ê¸°ë¥¼ í´ë¦­í•˜ë©´ ì…ë ¥ë€ìœ¼ë¡œ ì´ë™í•©ë‹ˆë‹¤
    </div>
    <div class="progress-bar-bg">
      <div class="progress-bar-fill" id="progressFill"></div>
    </div>
    <div class="progress-text" id="progressText">0 / 48</div>
  </div>

  <!-- ë¬¸í•­ êµ¬ë¶„ì„  -->
  <div class="questions-header" id="questionsHeader">
    <div class="questions-header-line"></div>
    <div class="questions-header-text">ê²€ì‚¬ ë¬¸í•­</div>
    <div class="questions-header-line"></div>
  </div>

  <!-- ë¬¸í•­ í¼ -->
  <form id="miForm"></form>

  <div class="warning-bar" id="answerWarningBox"></div>

  <div class="submit-wrap" id="submitWrap">
    <button class="btn-submit" id="submitBtn" onclick="submitAnswers()">ê²°ê³¼ ë³´ê¸°</button>
  </div>

  <!-- ê²°ê³¼ ì„¹ì…˜ -->
  <div id="resultSection">
    <div class="result-header">
      <div class="result-eyebrow">ë‚˜ì˜ ë‹¤ì¤‘ì§€ëŠ¥ í”„ë¡œí•„</div>
      <div class="result-top3" id="top3Display"></div>
      <div class="result-sub" id="resultSub"></div>
    </div>

    <!-- ì°¨íŠ¸ -->
    <div class="chart-section">
      <div class="chart-title">ì§€ëŠ¥ ìœ í˜•ë³„ ì ìˆ˜</div>
      <div class="chart-toggle">
        <button class="btn-chart-toggle active" id="btnRadar" onclick="showChart('radar')">ë ˆì´ë” ì°¨íŠ¸</button>
        <button class="btn-chart-toggle" id="btnBar" onclick="showChart('bar')">ë§‰ëŒ€ ê·¸ë˜í”„</button>
      </div>
      <canvas id="radarChart"></canvas>
      <canvas id="barChart" style="display:none;"></canvas>
    </div>

    <!-- ì „ì²´ ì ìˆ˜ ë°” -->
    <div class="score-table-wrap">
      <div class="score-table-title">ì „ì²´ ì§€ëŠ¥ ì ìˆ˜</div>
      <div id="scoreRows"></div>
    </div>

    <!-- ìƒì„¸ ê²°ê³¼ -->
    <div class="result-fields" id="resultFields"></div>

    <div class="result-actions">
      <button class="btn-print" onclick="window.print()">ğŸ–¨ï¸ ì¸ì‡„ / PDF ì €ì¥</button>
      <button class="btn-restart" onclick="location.reload()">ì²˜ìŒìœ¼ë¡œ ëŒì•„ê°€ê¸°</button>
    </div>
  </div>

</div>

<script>
// â•â• ì„¤ì • â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
// âš ï¸ Firebase í”„ë¡œì íŠ¸ IDë¥¼ ì•„ë˜ì— ì…ë ¥í•˜ì„¸ìš”
// Firebase Console â†’ í”„ë¡œì íŠ¸ ì„¤ì • â†’ ì¼ë°˜ â†’ í”„ë¡œì íŠ¸ ID
const FN = "https://us-central1-multiple-intelligence-test.cloudfunctions.net";

let questionData = [], answers = {}, lastSearchResult = null;
let radarChart = null, barChart = null;
let adminPassword = null;

async function api(endpoint, body = {}) {
  const r = await fetch(`${FN}/${endpoint}`, {
    method: "POST", headers: { "Content-Type": "application/json" },
    body: JSON.stringify(body)
  });
  const d = await r.json();
  if (!r.ok) throw new Error(d.error || "ì„œë²„ ì˜¤ë¥˜");
  return d;
}

function showWarning(id, msg) {
  const el = document.getElementById(id);
  el.textContent = msg; el.style.display = "block";
  setTimeout(() => el.style.display = "none", 5000);
}

// â”€â”€ ê´€ë¦¬ì â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
document.getElementById("adminOverlay").addEventListener("click", e => {
  if (e.target === document.getElementById("adminOverlay")) closeAdmin();
});
function openAdmin() {
  document.getElementById("adminOverlay").classList.add("open");
  document.getElementById("modalTitle").textContent = "ê´€ë¦¬ì ì¸ì¦";
  document.getElementById("pwPanel").style.display   = "block";
  document.getElementById("listPanel").style.display = "none";
  document.getElementById("pwInput").value = "";
  document.getElementById("pwError").style.display = "none";
  setTimeout(() => document.getElementById("pwInput").focus(), 100);
}
function closeAdmin() { document.getElementById("adminOverlay").classList.remove("open"); }

async function doAdminLogin() {
  const pw = document.getElementById("pwInput").value.trim();
  if (!pw) return;
  try {
    const data = await api("adminLogin", { password: pw });
    if (data.ok) {
      adminPassword = pw;
      document.getElementById("modalTitle").textContent = "ê´€ë¦¬ì Â· ì‘ë‹µ ëª©ë¡";
      document.getElementById("pwPanel").style.display   = "none";
      document.getElementById("listPanel").style.display = "block";
      document.getElementById("pwError").style.display   = "none";
      loadAdminList();
    } else {
      document.getElementById("pwError").style.display = "block";
      document.getElementById("pwInput").value = "";
      document.getElementById("pwInput").focus();
    }
  } catch(e) {
    document.getElementById("pwError").textContent = "ì˜¤ë¥˜: " + e.message;
    document.getElementById("pwError").style.display = "block";
  }
}

async function loadAdminList() {
  const listEl = document.getElementById("adminList");
  const countEl = document.getElementById("adminCount");
  listEl.innerHTML = `<div style="text-align:center;padding:30px;color:var(--ink2);font-size:13px;">ë¶ˆëŸ¬ì˜¤ëŠ” ì¤‘â€¦</div>`;
  try {
    const data = await api("adminGetResults", { password: adminPassword });
    const results = data.results || [];
    const active = results.filter(r => !r.expired).length;
    countEl.textContent = `ì „ì²´ ${results.length}ê±´ Â· ìœ íš¨ ${active}ê±´`;
    if (!results.length) { listEl.innerHTML = `<div class="admin-empty">ì‘ë‹µ ë°ì´í„°ê°€ ì—†ìŠµë‹ˆë‹¤.</div>`; return; }
    listEl.innerHTML = results.map(r => {
      const dt = r.time ? new Date(r.time) : null;
      const dtStr = dt
        ? `${dt.getFullYear()}.${String(dt.getMonth()+1).padStart(2,"0")}.${String(dt.getDate()).padStart(2,"0")} ${String(dt.getHours()).padStart(2,"0")}:${String(dt.getMinutes()).padStart(2,"0")}`
        : "â€“";
      const badge = r.expired
        ? `<span class="admin-item-badge badge-expired">ë§Œë£Œ</span>`
        : `<span class="admin-item-badge badge-active">ìœ íš¨</span>`;
      return `
        <div class="admin-item${r.expired?" expired":""}" id="item-${r.id}">
          <div>
            <div class="admin-item-name">${r.name} ${badge}</div>
            <div class="admin-item-time">${dtStr}</div>
            <div class="admin-item-type">${r.topType||"â€“"} (${r.topScore||0}ì )</div>
          </div>
          <button class="btn-view-result" onclick="adminViewResult('${r.id}')">ê²°ê³¼ ë³´ê¸°</button>
          <button class="btn-del" onclick="adminDelete('${r.id}','${r.name}')">ì‚­ì œ</button>
        </div>`;
    }).join("");
  } catch(e) {
    listEl.innerHTML = `<div style="color:#c0392b;font-size:13px;padding:20px;">ì˜¤ë¥˜: ${e.message}</div>`;
  }
}

async function adminViewResult(docId) {
  try {
    const data = await api("adminGetResults", { password: adminPassword });
    const item = (data.results||[]).find(r => r.id === docId);
    if (!item) { alert("ë°ì´í„°ë¥¼ ì°¾ì„ ìˆ˜ ì—†ìŠµë‹ˆë‹¤."); return; }
    closeAdmin();
    // ì„œë²„ì—ì„œ í•´ì„¤ í¬í•¨ ê²°ê³¼ ë°›ê¸°
    const res = await api("getResultByScores", { typeScores: item.typeScores });
    renderResult(res.result);
  } catch(e) { alert("ì˜¤ë¥˜: " + e.message); }
}

async function adminDelete(docId, name) {
  if (!confirm(`"${name}"ì˜ ê²°ê³¼ë¥¼ ì‚­ì œí•˜ì‹œê² ìŠµë‹ˆê¹Œ?`)) return;
  try {
    await api("adminDeleteResult", { password: adminPassword, docId });
    document.getElementById(`item-${docId}`)?.remove();
    const remaining = document.querySelectorAll(".admin-item").length;
    const active    = document.querySelectorAll(".admin-item:not(.expired)").length;
    document.getElementById("adminCount").textContent = `ì „ì²´ ${remaining}ê±´ Â· ìœ íš¨ ${active}ê±´`;
  } catch(e) { alert("ì‚­ì œ ì‹¤íŒ¨: " + e.message); }
}

// â”€â”€ í˜ì´ì§€ ë¡œë“œ â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
window.onload = async () => {
  // ì´ë¦„ ì…ë ¥ ì‹œ reminder ìˆ¨ê¹€
  document.getElementById("nameInput").addEventListener("input", () => {
    if (document.getElementById("nameInput").value.trim())
      document.getElementById("nameReminderBar").style.display = "none";
  });

  document.getElementById("spinner").style.display  = "block";
  document.getElementById("miForm").style.display   = "none";
  document.getElementById("submitWrap").style.display = "none";

  try {
    const data = await api("getQuestions", {});
    const qs = data.questions || [];
    if (qs.length === 0) throw new Error("ë¬¸í•­ ë°ì´í„°ê°€ ì—†ìŠµë‹ˆë‹¤. Firestore 'ë¬¸í•­ì‹œíŠ¸' ì»¬ë ‰ì…˜ì„ í™•ì¸í•˜ì„¸ìš”.");
    renderQuestions(qs);
    document.getElementById("spinner").style.display         = "none";
    document.getElementById("miForm").style.display          = "block";
    document.getElementById("submitWrap").style.display      = "block";
    document.getElementById("progressWrap").style.display    = "block";
    document.getElementById("questionsHeader").style.display = "flex";
    document.getElementById("progressText").textContent = `0 / ${qs.length}`;
  } catch(e) {
    document.getElementById("spinner").style.display = "none";
    document.getElementById("miForm").innerHTML =
      `<div style="text-align:center;padding:60px 0;color:#c0392b;font-size:14px;line-height:2;">
        âš ï¸ ë¬¸í•­ì„ ë¶ˆëŸ¬ì˜¤ì§€ ëª»í–ˆìŠµë‹ˆë‹¤.<br>
        <span style="font-size:12px;color:#999;">${e.message}</span><br>
        <span style="font-size:11px;color:#aaa;">Firebase Functionsê°€ ë°°í¬ë˜ì—ˆëŠ”ì§€ í™•ì¸í•˜ì„¸ìš”.</span>
      </div>`;
    document.getElementById("miForm").style.display    = "block";
    document.getElementById("submitWrap").style.display = "block";
  }
};

// â”€â”€ ë¬¸í•­ ë Œë”ë§ â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
function renderQuestions(data) {
  questionData = data;
  const form = document.getElementById("miForm");
  form.innerHTML = "";
  data.forEach((q, i) => {
    const div = document.createElement("div");
    div.className = "question";
    let choicesHtml = "";
    for (let j = 1; j <= 5; j++) {
      const label = q[`select${j}`];
      const score = q[`score${j}`];
      if (!label || label === "") continue;
      choicesHtml += `<button type="button" class="btn-choice" onclick="selectAnswer('${q.id}',${score},this)">${label}</button>`;
    }
    div.innerHTML = `
      <div class="q-meta">
        <div class="q-num">${String(i+1).padStart(2,"0")}</div>
        <div class="q-text">${q.text}</div>
      </div>
      <div class="q-choices">${choicesHtml}</div>`;
    form.appendChild(div);
  });
}

// â”€â”€ ë‹µë³€ ì„ íƒ â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
function selectAnswer(qid, score, btn) {
  answers[qid] = score;
  btn.closest(".q-choices").querySelectorAll(".btn-choice").forEach(b => b.classList.remove("selected"));
  btn.classList.add("selected");
  btn.closest(".question")?.classList.remove("unanswered");
  const done  = Object.keys(answers).length;
  const total = questionData.length || 48;
  document.getElementById("progressFill").style.transform = `scaleX(${done/total})`;
  document.getElementById("progressText").textContent = `${done} / ${total}`;
  // ì´ë¦„ ì•ˆë‚´
  const reminder = document.getElementById("nameReminderBar");
  if (!document.getElementById("nameInput").value.trim()) {
    reminder.style.display = "block";
  } else {
    reminder.style.display = "none";
  }
}

// â”€â”€ ì´ë¦„ ê²€ìƒ‰ â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
async function searchPrevious() {
  const name = document.getElementById("nameInput").value.trim();
  if (!name) return showWarning("searchWarningBox", "ì´ë¦„ì„ ì…ë ¥í•´ì£¼ì„¸ìš”.");
  const box = document.getElementById("searchResponse");
  box.innerHTML = `<div style="font-size:13px;color:var(--ink2);padding:10px 0;">ê²€ìƒ‰ ì¤‘â€¦</div>`;
  try {
    const data = await api("getUserResult", { name });
    lastSearchResult = data.found ? data.result : null;
    if (data.found) {
      box.innerHTML = `<div class="confirm-box">
        <p>ì´ì „ ê²€ì‚¬ ê¸°ë¡ì´ ìˆìŠµë‹ˆë‹¤. ê²°ê³¼ë¥¼ ë°”ë¡œ ë³´ì‹œê² ìŠµë‹ˆê¹Œ?</p>
        <div class="confirm-btns">
          <button class="btn-yes" onclick="confirmLoad(true)">ì˜ˆ, ê²°ê³¼ ë³´ê¸°</button>
          <button class="btn-no"  onclick="confirmLoad(false)">ìƒˆë¡œ ê²€ì‚¬í•˜ê¸°</button>
        </div></div>`;
    } else {
      box.innerHTML = `<div class="confirm-box">
        <p>ê¸°ì¡´ ê¸°ë¡ì´ ì—†ìŠµë‹ˆë‹¤. ì§€ê¸ˆ ë°”ë¡œ ê²€ì‚¬ë¥¼ ì‹œì‘í•˜ì‹œê² ìŠµë‹ˆê¹Œ?</p>
        <div class="confirm-btns">
          <button class="btn-yes" onclick="confirmLoad(true,true)">ì˜ˆ, ì‹œì‘í•˜ê¸°</button>
          <button class="btn-no"  onclick="confirmLoad(false)">ì·¨ì†Œ</button>
        </div></div>`;
    }
  } catch(e) {
    box.innerHTML = `<div style="color:#e05252;font-size:13px;padding:10px 0;">ì˜¤ë¥˜: ${e.message}</div>`;
  }
}

function confirmLoad(ok, isNew = false) {
  document.getElementById("searchResponse").innerHTML = "";
  if (ok && lastSearchResult) renderResult(lastSearchResult);
  else if (!ok) location.reload();
}

// â”€â”€ ë‹µë³€ ì œì¶œ â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
async function submitAnswers() {
  const name = document.getElementById("nameInput").value.trim();
  if (!name) {
    showWarning("answerWarningBox", "âš ï¸ ì„±í•¨ì„ ì…ë ¥í•´ì£¼ì„¸ìš”. í˜ì´ì§€ ìƒë‹¨ ì´ë¦„ ì…ë ¥ë€ì„ ì±„ì›Œì£¼ì„¸ìš”.");
    document.getElementById("answerWarningBox").scrollIntoView({ behavior: "smooth", block: "center" });
    return;
  }
  const unanswered = questionData.filter(q => answers[q.id] === undefined);
  if (unanswered.length) {
    document.querySelectorAll(".question.unanswered").forEach(el => el.classList.remove("unanswered"));
    const nums = unanswered.map(q => questionData.findIndex(qq => qq.id === q.id) + 1);
    unanswered.forEach(q => {
      const idx = questionData.findIndex(qq => qq.id === q.id);
      const qEls = document.querySelectorAll(".question");
      if (qEls[idx]) qEls[idx].classList.add("unanswered");
    });
    const msg = unanswered.length === 1
      ? `âš ï¸ ${nums[0]}ë²ˆ ë¬¸í•­ì´ ì„ íƒë˜ì§€ ì•Šì•˜ìŠµë‹ˆë‹¤.`
      : `âš ï¸ ${unanswered.length}ê°œ ë¬¸í•­ì´ ì„ íƒë˜ì§€ ì•Šì•˜ìŠµë‹ˆë‹¤: ${nums.join(", ")}ë²ˆ`;
    showWarning("answerWarningBox", msg);
    const firstIdx = questionData.findIndex(qq => qq.id === unanswered[0].id);
    document.querySelectorAll(".question")[firstIdx]?.scrollIntoView({ behavior: "smooth", block: "center" });
    return;
  }
  document.getElementById("answerWarningBox").style.display = "none";
  const btn = document.getElementById("submitBtn");
  btn.disabled = true; btn.textContent = "ë¶„ì„ ì¤‘â€¦";
  try {
    const data = await api("saveAnswers", { name, answers });
    renderResult(data.result);
  } catch(e) {
    alert("ì˜¤ë¥˜: " + e.message);
    btn.disabled = false; btn.textContent = "ê²°ê³¼ ë³´ê¸°";
  }
}

// â”€â”€ ê²°ê³¼ ë Œë”ë§ â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
function renderResult(result) {
  if (!result || !result.length) { alert("ê²°ê³¼ë¥¼ ë¶ˆëŸ¬ì˜¬ ìˆ˜ ì—†ìŠµë‹ˆë‹¤."); return; }

  ["miForm","submitWrap","progressWrap","questionsHeader"].forEach(id => {
    document.getElementById(id).style.display = "none";
  });
  document.querySelector(".intro-cards").style.display = "none";
  document.querySelector(".name-section").style.display = "none";
  document.getElementById("searchResponse").innerHTML = "";

  const now = new Date();
  document.getElementById("printDate").textContent =
    `${now.getFullYear()}. ${now.getMonth()+1}. ${now.getDate()} ì¶œë ¥`;

  // ì ìˆ˜ ë‚´ë¦¼ì°¨ìˆœ ì •ë ¬
  const sorted = [...result].sort((a,b) => b.ì ìˆ˜ - a.ì ìˆ˜);

  // ìƒìœ„ 3ê°œ ë°°ì§€
  const rankLabels = ["1st","2nd","3rd"];
  document.getElementById("top3Display").innerHTML = sorted.slice(0,3).map((r,i) => `
    ${i>0?'<div style="width:1px;height:50px;background:var(--border);margin:auto 4px;"></div>':''}
    <div class="top-badge">
      <div class="top-rank">${rankLabels[i]}</div>
      <div class="top-name${i===0?' first':''}">${r.ì§€ëŠ¥ìœ í˜•}</div>
      <div class="top-score">${r.ì ìˆ˜}ì </div>
    </div>`).join("");

  document.getElementById("resultSub").textContent =
    `${sorted[0].ì§€ëŠ¥ìœ í˜•} Â· ${sorted[1].ì§€ëŠ¥ìœ í˜•} Â· ${sorted[2].ì§€ëŠ¥ìœ í˜•} ì¤‘ì‹¬ì˜ ì§€ëŠ¥ í”„ë¡œí•„`;

  // ì „ì²´ ì ìˆ˜ ë°”
  const maxScore = Math.max(...sorted.map(r=>r.ì ìˆ˜), 1);
  document.getElementById("scoreRows").innerHTML = sorted.map((r,i) => `
    <div class="score-row${i===0?' top1':''}">
      <div class="score-type">${i<3?['â‘ ','â‘¡','â‘¢'][i]+' ':''}${r.ì§€ëŠ¥ìœ í˜•}</div>
      <div><div class="score-bar-bg"><div class="score-bar-fill" style="width:${(r.ì ìˆ˜/maxScore)*100}%"></div></div></div>
      <div class="score-val${i===0?' top1':''}">${r.ì ìˆ˜}</div>
    </div>`).join("");

  // ì°¨íŠ¸
  const labels = sorted.map(r=>r.ì§€ëŠ¥ìœ í˜•);
  const scores = sorted.map(r=>r.ì ìˆ˜);
  drawRadar(labels, scores);
  drawBar(labels, scores);

  // ìƒì„¸ ì„¤ëª… (ìƒìœ„ 3ê°œ)
  const fields = ["í‰ê°€","ìê¸°ê°œë°œíŒ","ì„±ì¥íŒ","ê°•ì ","ì•½ì "];
  const fieldLabels = { "í‰ê°€":"í‰ê°€", "ìê¸°ê°œë°œíŒ":"ìê¸°ê°œë°œ íŒ", "ì„±ì¥íŒ":"ì„±ì¥ íŒ", "ê°•ì ":"ê°•ì ", "ì•½ì ":"ì•½ì " };
  document.getElementById("resultFields").innerHTML = sorted.slice(0,3).map(r => {
    const rows = fields.filter(f=>r[f]).map(f=>`
      <div class="field-row">
        <div class="field-key">${fieldLabels[f]}</div>
        <div class="field-val">${r[f]}</div>
      </div>`).join("");
    return rows ? `<div class="field-type-title">${r.ì§€ëŠ¥ìœ í˜•} (${r.ì ìˆ˜}ì )</div>${rows}` : "";
  }).join("");

  document.getElementById("resultSection").style.display = "block";
  setTimeout(() => document.getElementById("resultSection").scrollIntoView({ behavior:"smooth" }), 100);
}

// â”€â”€ ì°¨íŠ¸ â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
function drawRadar(labels, scores) {
  if (radarChart) { radarChart.destroy(); radarChart = null; }
  radarChart = new Chart(document.getElementById("radarChart").getContext("2d"), {
    type: "radar",
    data: {
      labels,
      datasets: [{
        label: "ë‹¤ì¤‘ì§€ëŠ¥ ì ìˆ˜",
        data: scores,
        backgroundColor: "rgba(184,144,58,0.15)",
        borderColor: "rgba(184,144,58,1)",
        borderWidth: 2,
        pointRadius: 5,
        pointBackgroundColor: "rgba(184,144,58,1)"
      }]
    },
    options: {
      responsive: true,
      plugins: { legend: { display: false } },
      scales: {
        r: {
          min: 0, max: 30, ticks: { stepSize: 5, font: { family: "Noto Serif KR" }, color: "#999" },
          pointLabels: { font: { family: "Noto Serif KR", size: 13 }, color: "#4a4540" },
          grid: { color: "rgba(0,0,0,0.07)" }
        }
      }
    }
  });
}

function drawBar(labels, scores) {
  if (barChart) { barChart.destroy(); barChart = null; }
  barChart = new Chart(document.getElementById("barChart").getContext("2d"), {
    type: "bar",
    data: {
      labels,
      datasets: [{
        label: "ì ìˆ˜",
        data: scores,
        backgroundColor: scores.map((_,i) => i===0?"rgba(184,144,58,0.9)":i<3?"rgba(212,170,90,0.7)":"rgba(212,170,90,0.35)"),
        borderColor: "rgba(184,144,58,1)",
        borderWidth: 1,
        barThickness: 28
      }]
    },
    options: {
      responsive: true,
      plugins: { legend: { display: false }, tooltip: { callbacks: { label: ctx=>`  ${ctx.raw}ì ` } } },
      scales: {
        y: { beginAtZero: true, max: 30, ticks: { stepSize: 5, font: { family: "Noto Serif KR" }, color: "#4a4540" }, grid: { color: "rgba(0,0,0,0.05)" } },
        x: { ticks: { font: { family: "Noto Serif KR", size: 11 }, color: "#4a4540" }, grid: { color: "rgba(0,0,0,0.05)" } }
      }
    }
  });
}

function showChart(type) {
  document.getElementById("radarChart").style.display = type==="radar" ? "block" : "none";
  document.getElementById("barChart").style.display   = type==="bar"   ? "block" : "none";
  document.getElementById("btnRadar").classList.toggle("active", type==="radar");
  document.getElementById("btnBar").classList.toggle("active",   type==="bar");
}
</script>
</body>
</html>
